# Документация по приложению Health Tracker

## Общая информация

Health Tracker - это веб-приложение на Django для отслеживания веса и расчета индекса массы тела (BMI). Приложение позволяет пользователям регистрироваться, вводить данные о своем весе, просматривать статистику и анализировать изменения со временем.

## Архитектура приложения

Проект состоит из двух основных приложений:
- `users` - управление пользователями и профилями
- `tracker` - отслеживание веса и статистика

### Структура проекта

```
health_tracker/          # Основной проект Django
├── health_tracker/      # Настройки Django
│   ├── __init__.py
│   ├── settings.py      # Конфигурация проекта
│   ├── urls.py          # Основные маршруты
│   ├── wsgi.py
│   └── asgi.py
├── tracker/             # Приложение отслеживания веса
│   ├── __init__.py
│   ├── admin.py
│   ├── apps.py
│   ├── models.py        # Модель WeightEntry
│   ├── views.py         # Представления для отслеживания веса
│   ├── forms.py         # Формы для работы с весом
│   ├── urls.py          # Маршруты отслеживания
│   └── migrations/      # Миграции БД
├── users/               # Приложение пользователей
│   ├── __init__.py
│   ├── apps.py
│   ├── models.py        # Модель CustomUser и UserProfile
│   ├── views.py         # Представления для аутентификации
│   ├── forms.py         # Формы регистрации и аутентификации
│   └── migrations/      # Миграции БД
├── templates/           # HTML шаблоны
│   ├── base.html        # Базовый шаблон
│   ├── tracker/         # Шаблоны отслеживания
│   └── users/           # Шаблоны пользователей
├── manage.py            # Утилита управления Django
└── db.sqlite3           # База данных SQLite
```

## Модели данных

### CustomUser (users/models.py)
Расширенная модель пользователя, наследующая от AbstractUser:

- `username` - имя пользователя (уникальное)
- `email` - email (уникальный)
- `first_name` - имя
- `last_name` - фамилия
- `password` - пароль (наследуется)

### UserProfile (users/models.py)
Профиль пользователя:

- `user` - связь с пользователем (OneToOne)
- `date_of_birth` - дата рождения (DateField, опционально)
- `height` - рост в сантиметрах (PositiveIntegerField, опционально)
- `gender` - пол (CharField, варианты: 'M', 'F', 'O')

### WeightEntry (tracker/models.py)
Запись о весе:

- `user` - пользователь (ForeignKey к CustomUser)
- `weight` - вес в килограммах (FloatField)
- `date` - дата измерения (DateField, по умолчанию сегодня)

Методы:
- `calculate_bmi()` - расчет индекса массы тела на основе роста из профиля

## URL-маршруты

### Основные маршруты (health_tracker/urls.py):

- `/admin/` - административная панель
- `/register/` - регистрация пользователя
- `/login/` - вход в систему
- `/logout/` - выход из системы
- `/profile/` - профиль пользователя
- `/profile/edit/` - редактирование профиля
- `/weight/add/` - добавление записи о весе
- `/weight/` - список записей о весе
- `/weight/<int:pk>/edit/` - редактирование записи
- `/weight/<int:pk>/delete/` - удаление записи
- `/statistics/` - статистика и графики
- `/` - главная страница

### Дополнительные маршруты (tracker/urls.py):
- `/` - главная страница (home_view)
- `/weight/` - список записей (WeightListView)

## Формы

### CustomUserCreationForm (users/forms.py)
Форма регистрации пользователя:
- username
- email
- password1 и password2
- first_name
- last_name
- date_of_birth
- height
- gender

### WeightEntryForm (tracker/forms.py)
Форма для ввода данных о весе:
- weight (вес)
- date (дата)

Содержит валидацию:
- Дата не может быть в будущем
- Нельзя создать несколько записей для одной даты

## Представления

### tracker/views.py

- `home_view` - главная страница (доступна без аутентификации)
- `add_weight` - добавление записи о весе (требует аутентификации)
- `WeightListView` - список записей о весе (требует аутентификации)
- `WeightUpdateView` - редактирование записи (требует аутентификации)
- `WeightDeleteView` - удаление записи
- `update_or_create_weight` - обновление или создание записи
- `statistics_view` - статистика и графики (требует аутентификации)

### users/views.py

- `register_view` - регистрация пользователя
- `login_view` - аутентификация пользователя
- `profile_view` - отображение профиля
- `logout_view` - выход из системы
- `ProfileUpdateView` - редактирование профиля (UpdateView)

## Шаблоны

### Базовые шаблоны
- `templates/base.html` - основной шаблон с навигацией и Bootstrap

### Шаблоны отслеживания (templates/tracker/)
- `home.html` - главная страница
- `statistics.html` - статистика с графиками
- `weight_list.html` - список записей о весе
- `add_weight.html` - форма добавления веса
- `weight_edit.html` - форма редактирования
- `weight_confirm_delete.html` - подтверждение удаления
- `weight_confirm_update.html` - подтверждение обновления

### Шаблоны пользователей (templates/users/)
- `login.html` - форма входа
- `register.html` - форма регистрации
- `profile.html` - страница профиля
- `profile_edit.html` - редактирование профиля

## Функциональность

### Регистрация и аутентификация
- Регистрация новых пользователей с созданием профиля
- Вход и выход из системы
- Редактирование профиля

### Отслеживание веса
- Добавление новых записей о весе
- Просмотр списка записей
- Редактирование и удаление записей
- Валидация: одна запись на дату

### Статистика
- Расчет индекса массы тела (BMI)
- Графики изменения веса и BMI
- Классификация BMI по категориям:
  - Недостаточная масса (менее 18.5)
  - Норма (18.5-24.9)
  - Избыточный вес (25-29.9)
  - Ожирение (30 и выше)

## Установка и запуск

### Требования
- Python 3.8+
- Django 5.0.3
- djangorestframework

### Установка
1. Клонируйте репозиторий
2. Создайте виртуальное окружение:
   ```
   python -m venv venv
   ```
3. Активируйте виртуальное окружение:
   - Windows: `venv\Scripts\activate`
   - Linux/Mac: `source venv/bin/activate`
4. Установите зависимости:
   ```
   pip install django djangorestframework
   ```
5. Выполните миграции:
   ```
   python manage.py migrate
   ```
6. Создайте суперпользователя (опционально):
   ```
   python manage.py createsuperuser
   ```
7. Запустите сервер разработки:
   ```
   python manage.py runserver
   ```

Приложение будет доступно по адресу http://127.0.1:8000/

## Используемые технологии

- Django 5.0.3 - веб-фреймворк
- SQLite - база данных
- Bootstrap 5 - стилизация интерфейса
- Chart.js - визуализация данных
- Django REST Framework - REST API (при наличии)

## Особенности реализации

1. Использование кастомной модели пользователя для расширения стандартной
2. Валидация уникальности записей по дате для каждого пользователя
3. Автоматический расчет BMI на основе роста из профиля
4. Интерактивные графики для визуализации изменений
5. Подтверждение операций редактирования и удаления
6. Защита страниц аутентификацией